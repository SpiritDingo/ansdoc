### **–ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ NFS –∏–∑ Windows –≤ openSUSE —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –¥–æ–º–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (Active Directory)**

–ß—Ç–æ–±—ã —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å NFS-—à–∞—Ä—É —Å Windows –Ω–∞ openSUSE —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏ –¥–æ–º–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –Ω—É–∂–Ω–æ:  
1. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å NFS –Ω–∞ Windows** —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ UID/GID –∏–ª–∏ Kerberos-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π.  
2. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å openSUSE** –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–æ–º–µ–Ω–æ–º (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ).  
3. **–°–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–∞–ø–∫—É**, —É–∫–∞–∑–∞–≤ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.  

---

## **1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ NFS –Ω–∞ Windows**
### **1.1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ NFS-—Å–µ—Ä–≤–µ—Ä–∞**
1. –û—Ç–∫—Ä–æ–π—Ç–µ **"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–æ–º"** ‚Üí **"–î–æ–±–∞–≤–∏—Ç—å —Ä–æ–ª–∏ –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã"**.  
2. –í—ã–±–µ—Ä–∏—Ç–µ:  
   - **–°–ª—É–∂–±–∞ NFS** ‚Üí **–°–µ—Ä–≤–µ—Ä NFS**  
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–ª—É–∂–±—É **Server for NFS**.

### **1.2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—â–µ–π –ø–∞–ø–∫–∏**
1. –ö–ª–∏–∫–Ω–∏—Ç–µ –ø—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –Ω–∞ –ø–∞–ø–∫–µ ‚Üí **–°–≤–æ–π—Å—Ç–≤–∞** ‚Üí **NFS Sharing**.  
2. –ù–∞–∂–º–∏—Ç–µ **Manage NFS Sharing** –∏ –∑–∞–¥–∞–π—Ç–µ:  
   - **Anonymous UID** –∏ **Anonymous GID** (–¥–æ–ª–∂–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å UID/GID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Linux).  
   - –ò–ª–∏ –≤–∫–ª—é—á–∏—Ç–µ **Kerberos**, –µ—Å–ª–∏ –Ω—É–∂–Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è.  

#### **–ï—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Kerberos (–ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–±)**
–í PowerShell (–æ—Ç –∞–¥–º–∏–Ω–∞):  
```powershell
nfsadmin server config sec=sys  # –ò—Å–ø–æ–ª—å–∑—É–µ—Ç UNIX-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é (UID/GID)
Set-NfsMappingStore -EnableLdapMapping $false  # –û—Ç–∫–ª—é—á–∞–µ—Ç AD-–º–∞–ø–ø–∏–Ω–≥
Restart-Service NfsServer
```

#### **–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Kerberos (–±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Å–ø–æ—Å–æ–±)**
```powershell
nfsadmin server config sec=krb5  # –í–∫–ª—é—á–∞–µ—Ç Kerberos
Restart-Service NfsServer
```

---

## **2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ openSUSE –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–æ–º–µ–Ω–æ–º**
### **2.1. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Active Directory (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)**
```bash
sudo zypper install sssd krb5-client
sudo authselect select sssd with-mkhomedir --force
```
–ù–∞—Å—Ç—Ä–æ–π—Ç–µ `/etc/sssd/sssd.conf` –∏ `/etc/krb5.conf` –¥–ª—è –≤–∞—à–µ–≥–æ –¥–æ–º–µ–Ω–∞.

### **2.2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–º–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**
–£–∑–Ω–∞–π—Ç–µ `UID` –∏ `GID` –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
```bash
id username@domain
```
–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:
```
uid=10000(aduser) gid=10000(domain users) groups=...
```
(–ó–∞–ø–æ–º–Ω–∏—Ç–µ `10000:10000`)

---

## **3. –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ NFS –≤ openSUSE**
### **3.1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ NFS-–∫–ª–∏–µ–Ω—Ç–∞**
```bash
sudo zypper install nfs-client
```

### **3.2. –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–±–µ–∑ Kerberos)**
```bash
sudo mkdir -p /mnt/nfs_win
sudo mount -t nfs <Windows_IP>:/share /mnt/nfs_win -o vers=3,nolock,uid=10000,gid=10000
```
- `uid` –∏ `gid` –¥–æ–ª–∂–Ω—ã —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –Ω–∞ Windows.

### **3.3. –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å Kerberos (NFSv4)**
```bash
sudo mount -t nfs4 <Windows_IP>:/share /mnt/nfs_win -o sec=krb5,vers=4.2
```
–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –ø–æ–ª—É—á–∏—Ç–µ Kerberos-–±–∏–ª–µ—Ç:
```bash
kinit username@DOMAIN
```

### **3.4. –ê–≤—Ç–æ–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (`/etc/fstab`)**
–î–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É:
```bash
<Windows_IP>:/share  /mnt/nfs_win  nfs  vers=3,nolock,uid=10000,gid=10000  0  0
```
–ò–ª–∏ –¥–ª—è Kerberos:
```bash
<Windows_IP>:/share  /mnt/nfs_win  nfs4  sec=krb5,vers=4.2  0  0
```
–ü—Ä–∏–º–µ–Ω–∏—Ç–µ:
```bash
sudo mount -a
```

---

## **4. –ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è**
### **–û—à–∏–±–∫–∞: "Permission denied"**
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `UID/GID` —Å–æ–≤–ø–∞–¥–∞—é—Ç –Ω–∞ Windows –∏ Linux.  
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –Ω–∞ Windows –≤ NFS-—à–∞—Ä–µ —Ä–∞–∑—Ä–µ—à—ë–Ω –∞–Ω–æ–Ω–∏–º–Ω—ã–π –¥–æ—Å—Ç—É–ø –∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω Kerberos.  

### **–û—à–∏–±–∫–∞: "RPC timeout"**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –æ—Ç–∫—Ä—ã—Ç—ã –ª–∏ –ø–æ—Ä—Ç—ã **2049/TCP** –∏ **111/UDP** –≤ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–µ Windows.  

### **–û—à–∏–±–∫–∞: "Stale file handle"**
```bash
sudo umount -l /mnt/nfs_win
sudo mount -a
```

---

## **–ò—Ç–æ–≥**
| –°–ø–æ—Å–æ–± | –ö–æ–º–∞–Ω–¥–∞ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å |
|--------|----------------------|-------------------|
| **–ë–µ–∑ Kerberos** | `sudo mount -t nfs <IP>:/share /mnt/nfs_win -o vers=3,nolock,uid=10000,gid=10000` | –ï—Å–ª–∏ –Ω–µ –Ω—É–∂–Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è |
| **–° Kerberos** | `sudo mount -t nfs4 <IP>:/share /mnt/nfs_win -o sec=krb5,vers=4.2` | –ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –∑–∞—â–∏—â—ë–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø |

–ï—Å–ª–∏ –ø—Ä–∞–≤–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ `id username@domain` –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ NFS –Ω–∞ Windows. üöÄ